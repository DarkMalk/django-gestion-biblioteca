{% extends "layout.html" %}
{% block title %}
  <title>Books - Library System</title>
{% endblock title %}
{% block body %}
  <main class="w-full h-full p-8 gap-4 flex flex-col">
    <h1 class="text-3xl font-bold">Loans Management</h1>
    <section class="w-full flex flex-row gap-4 border rounded-lg border-gray-300 p-4">
      {% comment %} TODO: crear los filtros {% endcomment %}
      <input type="text"
             placeholder="Search by book title, or borrower name..."
             class="w-full md:w-2/3 p-2 border border-gray-300 placeholder:font-bold rounded text-sm outline-gray-400" />
      <select class="w-full md:w-1/3 border border-gray-300 rounded p-2 text-sm">
        <option value="all">All Loans</option>
        <option value="fiction">Returned</option>
        <option value="non-fiction">Active</option>
        <option value="science">Overdue</option>
      </select>
    </section>
    <section class="flex gap-4 border-2 rounded-lg border-gray-300">
      <table class="w-full text-sm text-left">
        <thead class="text-gray-500">
          <tr class="border-b border-gray-300">
            <th class="p-4">Book Title</th>
            <th class="p-4">Borrower</th>
            <th class="p-4">Checkout Date</th>
            <th class="p-4">Due Date</th>
            <th class="p-4">Return Date</th>
            <th class="p-4">Status</th>
            <th class="p-4">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for loan in loans %}
            <tr class="border-b border-gray-300 hover:bg-gray-100">
              <td class="p-4 font-semibold">{{ loan.book_title }}</td>
              <td class="p-4">{{ loan.user_name }}</td>
              <td class="p-4">{{ loan.request_date|date:"M j, Y" }}</td>
              <td class="p-4">{{ loan.due_date|date:"M j, Y" }}</td>
              <td class="p-4">
                {% if loan.return_date %}
                  {{ loan.return_date|date:"M j, Y" }}
                {% else %}
                  -
                {% endif %}
              </td>
              <td class="p-4">
                {% if loan.status == "returned" %}
                  <div class=" border border-blue-200 px-2.5 py-0.5 rounded-full w-fit text-xs font-bold text-blue-700 bg-blue-50">
                    {{ loan.status }}
                  </div>
                {% endif %}
                {% if loan.status == "active" %}
                  <div class=" border border-green-200 px-2.5 py-0.5 rounded-full w-fit text-xs font-bold text-green-700 bg-green-50">
                    {{ loan.status }}
                  </div>
                {% endif %}
                {% if loan.status == "overdue" %}
                  <div class=" border border-red-200 px-2.5 py-0.5 rounded-full w-fit text-xs font-bold text-red-700 bg-red-50">
                    {{ loan.status }}
                  </div>
                {% endif %}
              </td>
              <td class="p-4 flex items-center justify-center">
                <a href="{% url "loans" %}"
                   class="p-2 hover:bg-black/20 rounded transition-colors">{% include "icons/eye.html" %}</a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
    {% with loans as items %}
      {% include "components/pagination.html" %}
    {% endwith %}
  </main>
{% endblock body %}
